import unittest
from pygate.predefined.simulations import optical_gamma, simulation, PredefinedSimulations
from pygate.predefined.sources import sphere, Vec3
from pygate.utils.strs import assert_equal_ignoring_multiple_whitespaces as ae


class TestPredefinedSimulation(unittest.TestCase):
    def test_optical_gamma(self):
        mac = optical_gamma(sphere(0.1, Vec3(150.0, 0.0, 0.0, 'mm'))).render()
        ae(self, mac,
           '\n/gate/geometry/setMaterialDatabase    ./GateMaterials.db\n\n\n#=====================================================\n# GEOMETRY\n#=====================================================\n/gate/world/geometry/setXLength         400.0 cm\n/gate/world/geometry/setYLength         400.0 cm\n/gate/world/geometry/setZLength         400.0 cm\n\n/gate/world/daughters/name            OpticalSystem\n/gate/world/daughters/insert          box\n/gate/OpticalSystem/geometry/setXLength         400.0 cm\n/gate/OpticalSystem/geometry/setYLength         400.0 cm\n/gate/OpticalSystem/geometry/setZLength         400.0 cm\n/gate/OpticalSystem/setMaterial                 Air\n\n/gate/OpticalSystem/daughters/name            crystal\n/gate/OpticalSystem/daughters/insert          box\n/gate/crystal/placement/setTranslation    0.0 0.0 0.0 mm\n/gate/crystal/geometry/setXLength         30.0 mm\n/gate/crystal/geometry/setYLength         30.0 mm\n/gate/crystal/geometry/setZLength         30.0 mm\n/gate/crystal/setMaterial                 LYSO\n\n/gate/systems/OpticalSystem/crystal/attach   crystal\n\n/gate/crystal/attachCrystalSD\n\n\n\n\n\n#=====================================================\n# PHYSICS\n#=====================================================\n/gate/physics/addProcess PhotoElectric\n/gate/physics/processes/PhotoElectric/setModel StandardModel\n\n\n/gate/physics/addProcess Compton\n/gate/physics/processes/Compton/setModel StandardModel\n\n\n/gate/physics/addProcess RayleighScattering\n/gate/physics/processes/RayleighScattering/setModel PenelopeModel\n\n\n/gate/physics/addProcess ElectronIonisation\n/gate/physics/processes/ElectronIonisation/setModel StandardModel e-\n\n/gate/physics/processes/ElectronIonisation/setModel StandardModel e+\n\n\n/gate/physics/addProcess Bremsstrahlung\n/gate/physics/processes/Bremsstrahlung/setModel StandardModel e-\n\n/gate/physics/processes/Bremsstrahlung/setModel StandardModel e+\n\n\n/gate/physics/addProcess eMultipleScattering e+\n\n/gate/physics/addProcess eMultipleScattering e-\n\n/gate/physics/processList Enabled\n/gate/physics/processList Initialized\n\n\n#=====================================================\n# INITIALISATION\n#=====================================================\n/gate/run/initialize\n\n#=====================================================\n# SURFACES\n#=====================================================\n\n\n#=====================================================\n# DIGITIZER\n#=====================================================\n/gate/digitizer/Singles/insert opticaladder\n\n/gate/digitizer/Singles/insert readout\n/gate/digitizer/Singles/readout/setDepth  1\n\n#=====================================================\n# SOURCE\n#=====================================================\n/gate/source/addSource sphere_source\n/gate/source/sphere_source/gps/type Volume\n/gate/source/sphere_source/gps/shape Sphere\n/gate/source/sphere_source/gps/radius 0.1 mm \n\n# Placement\n/gate/source/sphere_source/gps/centre 150.0 0.0 0.0 mm \n/gate/source/sphere_source/gps/particle gamma \n/gate/source/sphere_source/gps/monoenergy 511 keV\n\n/gate/source/sphere_source/setActivity 1000 becquerel\n/gate/source/sphere_source/gps/angtype iso\n/gate/source/sphere_source/gps/mintheta 90 deg \n/gate/source/sphere_source/gps/maxtheta 90 deg\n/gate/source/sphere_source/gps/minphi   0 deg\n/gate/source/sphere_source/gps/maxphi   0 deg\n\n\n/gate/source/list\n\n\n#=====================================================\n# PARAMETER\n#=====================================================\n/gate/random/setEngineName MersenneTwister\n/gate/random/setEngineSeed auto\n\n/gate/output/root/enable\n/gate/output/root/setFileName optical\n/gate/output/root/setRootHitFlag 1\n/gate/output/root/setRootSinglesFlag 1\n\n\n\n/gate/application/setTotalNumberOfPrimaries 10000\n/gate/application/start\n\n\n\n')
